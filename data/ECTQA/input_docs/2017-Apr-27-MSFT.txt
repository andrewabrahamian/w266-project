I wanted to dig into Azure a little bit. You gave us some really interesting statistics about gross margins going up, premium mix going up. One of the concerns I hear a lot from investors is what happens when we get these price cuts that go back and forth between you guys and AWS? And it doesn't seem like the price cuts this quarter really affected you guys. So I was hoping could sort of shed some light on it and how -- to what degree do those price cuts actually affect you? And then on the flip side, where does all that growth come from? Where do you get that sort of tripling of premium growth from? What kind of workloads are coming on board to kind of actually drive the underlying growth in that business?
Sure, thanks for the question, Keith. Let me start and then Amy, if you want, you can add. Again, Keith, I talked -- when we look at either the capital expense or the technical architecture -- and the general approach we take is about all of our cloud. When you look at what we're trying to get done between Azure, we don't really see these scenes across Azure, O365, Dynamics 365 and also the things that we're doing with Xbox LIVE, for example. All build as one cloud infrastructure and a set of rich services in the cloud. So for example, some of the cognitive capabilities that are there in Azure first come because of our first-party AI investments, whether it's been speech or vision or anything else. Even the infrastructure that is there in Azure came out of some of our first-party investments in Office 365 or again, Bing and other areas. So we have an approach which takes all of our cloud pieces together. And that same thing is reflected even in the customer journeys. I think the Maersk example I walked you through is probably a good one. While it may start with some commodity workload on Azure or it may start with Office 365, but then it will end up with HoloLens and someone using Dynamics 365 for increased automation. In the case of Maersk, they were using field service and operations inside of Dynamics 365. So to me, those high-level services will, over time, attach in Azure but also in Dynamics as well as in Office 365. So to me, that's why Azure is pretty strategic for us, not just for the attachment of high-level services and what is defined as Azure, but the all-up digital transformation opportunity. That's how Amy and I even think about our margin structure. We need to improve in each one on the elements, but all-up we need to improve because we think that increased opportunity is what's unique about our approach.
And I think what you're hearing in that answer from Satya, Keith, is really about whether the premium services exist as you heard at the Azure layer or whether they show themselves in our Productivity and Business Processes segment. The fact that you may see competition where there may be less differentiation, the real differentiation is where you've always been able to achieve margin and margin expansion, which is in the completeness of the solution or its delivery, the completeness of the business process change or not. And so I think, while I do understand that people ask a lot about that price competition at the lower level, I think what you're seeing is because we're able to continue to move people up the stack, including all the way up to the business process layer, I think you'll continue to see us be confident in our ability to move and create margin and growth.
Our next question comes from the line of Karl Keirstead with Deutsche Bank.
I've got a follow-up actually on Azure, maybe to you Satya. And it's the interplay between the cloud piece, Azure, and mostly the on-prem piece, what you guys call the server product. Most of your peers, obviously, when they're pivoting to the cloud, are seeing weakness on the on-prem side, but what's unique about Microsoft is not only is Azure growth accelerating, but your server product growth at 7% is up meaningfully year-over-year as well. So we're not seeing that trade-off with Microsoft. I suspect part of the explanation is that a lot of the Azure growth is net new, but I'm just curious, when do you think customers will actually start migrating existing on-prem Microsoft workloads into Azure such that, that server product line might start to decelerate? Do you think there's a prospect of that occurring in fiscal '18?
Yes, the time frames of these migrations and so on are a lot more complicated than they perhaps appear on the surface. So here's what we think of. For example, right when everyone's talking about the cloud, the most interesting part is the edge of the cloud. Whether it's IoT, whether it's the auto industry, whether it's what's happening in retail, essentially, compute is going where the data gets generated and increasingly, data is getting generated at the volumes in which it's drawing compute to it, which is the edge. So if you look at even our announcements over this quarter, a lot of what we have done with IoT is create an IoT edge. Of course, we have an amazing cloud with sort of the SaaS services for IoT, but the edge compute, the ability to run a neural network at the edge, do inferences at the edge is exciting. Azure Stack is going to completely change what hybrid is and the expectations customers have with hybrid. I mean, GEICO example is a good one. What's happening with SQL Server? SQL Server is no longer just about a database that's on-premise. It's a database that's on-premise that can be tiered with the cloud. Our single table can be extended to the cloud. The queries will work across both the tiering. And so to me, the innovative work we are doing is what I would characterize as the future of true distributed computing, which is it will remain distributed. And that's what we are building towards. We'll talk a lot more and build on -- about that architecture and what we're seeing with customers. Then, given that, what you are saying is true, which is there will be some which will be lift and shift of workloads, but then there is lift, shift and modernizing of workloads. And in that modernizing phase, it's not just being modernized to live only in what is called a cloud, but it will also be modernized to live in the edge of the cloud. And so that's the transformation at play, that's a multiyear and a generational transformation. Quarter-to-quarter, there will be all kinds of volatility, but what is clear to me and clear to Microsoft's engineers is that we have a very clear worldview of what it is that we want to get done and we stay focused on it.
And I think, Karl, to your question about how that shows up, it's why you hear us focus more on the all-up KPIs between Azure and this sort of transactional or on-premise number because the line between them, both strategically and literally, is more important to be blurred and going in that direction. And so this quarter, you saw a little bit healthier than we had thought, I pointed out. It tends to be -- in this instance, Japan was a little better. It can be product launch-related, it can be macro impacted. But whether or not you see that in transactional, the uber trend of being able to see it through the all-up KPI, the dynamics Satya has talked about, you're going to hear us talk more and more about whether it's a "on-prem server launch" or an Azure feature about the integration of the 2.
Our next question comes from the line of Heather Bellini with Goldman Sachs.
Again, I had a follow-up on Azure as well. I was just wondering, Satya, if you could share with us, and I know I've asked this in the past, but just kind of any qualitative commentary you could give us about PaaS adoption. And I'm also wondering in particular, given the high percentage of workloads on Azure running Linux, what type of services are you typically seeing run on top of the OS? And how do you see your monetization of those workloads playing out over time? And then Amy, just a follow-up for you would just be -- and I apologize, we did another earnings call tonight, so I might have missed it. But you usually give a comment about out-year OpEx on the call, and I was just wondering if you had any high-level thoughts there.
Sure, Heather, thanks for the question. Overall qualitatively in terms of PaaS adoption of Azure, a lot of it comes with what's happening, for example, in the services we talk about like IoT. We now have a much higher-level managed service. We even launched a new packaging of it with the IoT Central, which allows developers who are building IoT solutions and sort of assembling it themselves to be able to use this managed service to be that much more agile and productive. So that's usually the way we make the atomic parts available as well as these essentially SaaS services or PaaS services. Same thing with data. The DocumentDB is a massive thing for us. It's a planet scale database that supports JSON and much more, and we see that as a core part of the data tier for many, many applications. We even see -- or we see the end-user parts of the infrastructure when it comes to Enterprise Mobility. So all-up, we have multiple pieces. The other area is, of course, the entire tool chain of what's happening with Visual Studio to continuous integration to continuous deployment. And that's a place where we have a very, very differentiated solution for developers and developer productivity, which, in some sense, you can think of as it's kind of like the Office 365 for developers, but that's all part of Azure. So those are the places where there is PaaS services. But as I said earlier in response to the question, we also welcome the use of, I would say, the most atomic building blocks of Azure, whether it just be a Linux container, Azure functions, which is very cost-efficient for developers because we know that over time, maybe not just PaaS services in Azure, it could be, in fact, a Dynamics 365 module. I mean, the canonical example for me is someone who sort of collects data, does a prediction, ultimately then has to do something about that prediction, which means some automation, like field service. So a lot of what is Dynamics field service is actually in our module growth we are seeing because of Azure IoT. And that relationship is not just about Azure PaaS.
And to your specific question, Heather, on FY '18 OpEx, I did not, because we're going to see each other and have more time on May 10 at the analyst briefing, and that's where I'll take some more time to walk through FY '18.
Our next question comes from the line of Mark Moerdler with Bernstein Research.
Two questions. What was the drivers of the big growth in Dynamics 365? Is this large seasonality specifically in this quarter? Is it a big deal or should we expect growth in the same vicinity for the -- in your future? And then as a second question, as discussed in the previous -- one of the previous questions about Server & Tools and the healthiness of that growth, I'm trying to understand the drivers. Is this the product refresh cycle? Is it Azure driving customer upgrades? Is it something else? Can you give a bit more color? That would be helpful. I appreciate it.
Sure, Mark, and let me start and then Amy, you can add. On the Dynamics 365, we're at the very, very beginning phase of the transition of Dynamics from primarily being on-premise to now being a very modern, modular SaaS service. The Dynamics 365 momentum is picking up. I talked about the revenue growth rate. And that's definitely going to be what's going to be true in the quarters to come and the years to come. But we do have a huge on-premise base. There is still a need for those on-premise products. That will continue, but our focus is on transitioning to the cloud. And you've seen us do this successfully with Office 365. You've seen us do that with Azure. And now we're ready to do that mainstream across what has been traditionally known as CRM and ERP without, in fact, us thinking and talking about those suites because we think that's a pretty old concept to have suites like that, which is we have now really made the entire Dynamics 365 much more modular, modern and much more efficient for customers, so that's what's happening in Dynamics. Same thing on Azure, which is the driver is -- a lot of it is net new. IoT, for example, was not a workload on the old server world whereas it's one of the big workloads for us. Same thing with AI, not an old workload. So there's new growth in Azure. There is the lift, shift and modernize motion as well as well as a new need for the edge of the cloud. So all 3 of them are in play while recognizing we had a large business called the server licensing business. So we have 3 new things that we are driving and the -- a lot of large licensing pieces that are just transitioning into these 3 motions.
And in particular, in this quarter, how to think about, I think, some of the in-period outperformance versus what we see consistently, in the bucket of consistently, premium workload growth has been consistent for us. The double-digit annuity growth has been consistent for us and that, I think, is a driver we continue to look for and be confident in its execution quarter-to-quarter. In the more temporal bucket this quarter, as well as last, you saw a bit of it, some geo help in certain geos that may see and be more transactional in nature. Japan happens to be one of those geos. And then we are still seeing some post-launch impact, specifically in the Windows Server side and selling higher-end SKUs post-launch, which has to do with some of the value inherent. So that's how I kind of break down the drivers, Mark.
Our next question comes from the line of Walter Pritchard with Citi.
Two things, Amy. I think you mentioned in the script that Windows -- there was some Windows volatility around some new SKU pricing. Could you go into some detail there? And then, secondarily, I know we may get this at Analyst Day, but around 606, I know you're going to adopt that early, and I think that will change, to some degree, your annuity revenue. I wonder if you could give us any color, even directionally, on what percentage of that annuity revenue is licensed that after 606 will go up front.
Great. On 606, we will talk about it in detail, actually on May 10, in terms of the timing and what you can expect. You'll also note in the Q this quarter, we do give a look at the initial impact on an annual basis, using last year as an example. The biggest difference on an annual basis with the adoption of 606 will really just be the change from Windows OEM. Now what we will talk about in more detail is that the quarter-to-quarter results in any given year will be a little bit more volatile. But over any annual period, the biggest difference will really just be the change, in some ways, back to how we thought about OEM revenue. So that's what I would think of on 606.
And then question on the...
Oh Windows. I'm sorry, I answered them in the opposite order. And on the Windows pricing, which we talked about, we do and always have worked with Windows SKUs as we release new products and add new value. This quarter, we had a bit of a mix shift to a higher-end SKU. And starting in April, we've introduced other SKUs that have more value in them at lower processing specs. And so what you'll continue to see is that will normalize. Even though we saw some high-end SKUs this quarter do well, I would expect in Q4 to have the normal breadth of those SKUs and revert back to looking much more like the commercial PC market itself.
Our next question comes from the line of Brad Reback with Stifel.
Great. So 2 quick questions. First off, Amy, there's been a lot about talk about tax law changes on the corporate side. Would a repatriation holiday impact how you guys allocate capital back to shareholders? And then just real quickly, on the OpEx side, I know you don't want to get too specific, but over the last few years, you've been able to effectively reallocate upwards of $2 billion from the phone business elsewhere. Is there still a fair amount of ability to reallocate internally?
Great, let me take both of those. Let me separate your first question because I think you're really asking too, that I probably don't relate as directly and I should do that for you. We've been a long-time advocate of structural tax reform, and so we'll just wait and see how things play out. And as decisions get made and proposals clarified, we'll share more about what that means for us. Next, in terms of how we thought about that impacting capital return. As you know, I think we've been -- and executed significant capital return program over the past couple of years, including accelerating a buyback program that I think I feel very good about at the corporate level in terms of the value it's created. And so I wouldn't say that I view those 2 things as waiting for one to do the other. We've, in fact, continued to do what we thought created the most value for shareholders, which is to invest in ourselves, acquire companies that help us expand our TAM and grow, return dividends as well as repurchase shares. And we've continued to do that this quarter as well. I think you'll continue to see us take a balanced approach, but I don't think of those as being related. The last question on OpEx, I think over the past couple of years, we've continued to make decisions that said every dollar we spend, are we putting it in the right place for the long term, whether that's reallocating or adding new. And what we expect is to grow new markets and perform really well in them with every dollar that we invest, whether frankly, Brad, it's in OpEx or in COGS. At this point, both of those are very large buckets of investments. What Satya and I as well as the whole senior leadership team spend the majority of our time, picking markets and making sure we execute in them. So in terms of our ability to continue to do that, of course, there's opportunities. We learn frankly, I think, every week where we can do better and where we can continue to invest to accelerate. That being said, I don't view any OpEx number as a constraint. More, I view, is the return healthy? Is it growing the top line? Are we executing well on it? And if we are, it will make sense to spend more, and if we aren't, it won't. And so I tend to take that approach as opposed to solving for any one number.
Our next question comes from the line of Kirk Materne with Evercore ISI.
Amy, I want to follow up on your last point around investment and return on it. Around this time last year, you guys started spending a lot more or investing a lot more in OpEx on the Intelligent Cloud side in particular. This quarter, you saw Intelligent Cloud operating profit, on a constant currency basis, get back to growth again, which I think shows that those investments were indeed -- made some sense. Now that you've spent a lot, you've obviously added a lot in sales and marketing resources, R&D resources on that front. Could you just give us, I guess, qualitatively how you're thinking about that? It seemed like last year, you needed to catch up to a certain degree in terms of go-to-market capabilities. Do you feel better, I guess, where you are today versus your position, say, a year ago just in terms of being able to capture the opportunity on the Intelligent Cloud side?
I'll start and then I'll transition to you, Amy. I mean, I don't view it that narrowly quarter-to-quarter or even year-to-year. These are generational opportunities, what's at play when it comes to the Intelligent Cloud or what's happening in augmented reality. Either one of those things, I think if we started viewing it quarter-to-quarter or year-to-year, we'll completely miss the trend. We definitely need to be smart about 2 things that Amy said before, which is pick markets that are secular growth markets and got big TAM. And most importantly, what's our role in it? Is this something that the world needs Microsoft to be doing? Or is it well served by others? That's where we spend most of our cycles in. The fact that we put some salespeople, and then there's increased productivity is something that we obviously celebrate and we track very closely. But the places where we are more likely to go and put our OpEx in the coming quarters, in the coming years are going to be about revenue that's going to show up for multiple years out. And it won't be very transparent to you, right, and that's how it is. I mean, if we had not gotten started on some of the distributed computing infrastructure in a completely different place, we wouldn't even have Azure. But I completely understand that all of you measure us by what we have done for you lately, and that's a fine way and we'll keep account of it, but that's not how it works.
Yes, and I think the important part in what Satya said is the distinction between really engineering investments that take multiple years of investment and worldview on a TAM and holding ourselves accountable to sales and marketing investments and are they earning the right return? Are we doing them in the right way? Are they in the right market? Are we investing in the right types of people and the right capabilities? What I look and say that this number shows is that we are doing, and it is encouraging, that the plan that we put in place that the sales team has done a really terrific job of executing on. And all that does is build more confidence that both we picked a good market and we're investing in the right type of people to make sure we land that opportunity at customers. And then the most important thing is that the customer success is what will breed revenue for the next quarter, the next year. And especially in this market, a generational move here really means, especially for many of the workloads being moved, these pay off every year for the next 10.
Our next question comes from the line of Mark Murphy with JPMorgan.
Satya, I'm curious how is the pace of conversations around Internet of Things, machine learning and cognitive services? And also what are you seeing as the killer app types of use cases that could resonate with customers in terms of the more mainstream applicability? And also Amy, just given the strength in commercial bookings and also commercial bookings guidance, macroeconomically, do you see any signs of enterprise budgets opening up somewhat or different activity levels, more receptivity to transformative projects? I'm just trying to understand maybe how we can separate out your company-specific momentum against any conceivable kind of incremental macro tailwinds.
That's great, so let me start. The best way to think about how people are using, whether it's Azure, Dynamics 365 or other capabilities we have, is in the context of that digital transformation and the outcome. So when you say killer apps, the killer apps are how are customers able to reimagine how they think about customer engagement, how they think about employee empowerment or the operational efficiency or how they can change the products and the business models and the products. And if you look at even the examples I used in this quarterly earnings call, Maersk and what they're trying to do across all of those is pretty transformative. There is machine learning and AI, there is IoT, there is new type of business process automation with operations. All of that is sort of transforming Maersk. What ThyssenKrupp has done in their elevator business and other business units who are using anything from HoloLens to a front-line worker, to how they're fundamentally moving their business model from essentially the margin on the thing, to the margin on the service, which has machine learning and AI built into it. Those are the killer transformation opportunities that we are seeing. And in fact, it's not about, in fact, taking any old workload per se, but it's about reimagining what they want to do across these. And in that context, of course, they are lifting and shifting some of the older workloads but they're modernizing the entire business process flow. And that's what's, I think, the killer opportunity, not any one technology, but the entire flow.
And I think your question about, is it really budgets, I think you used the phrase opening up. What I think is really interesting is, I don't know, I read probably the same CIO surveys you all do. Frankly, the numbers in those in terms of IT spend or intent to spend aren't much different than we've seen. For me, what I think is missing in that question is really -- it's not about any one customer saying, "Wait, I'm going to spend 2% more or 3% more." These are companies actually deciding that change is required, not from an infrastructure perspective but to change how they're running their business itself. And so things that used to look more to them like capital expense through COGS or not just an IT budget, this is literally changing every business process they run or changing the services they offer and thinking about literally driving their revenue differently. And so I don't really associate it probably as much with a "budget" that sits in IT very narrowly. This is really about every budget that sits not just in IT but under every functional leader of a company being spent differently and being spent on our technology.
Our next question comes from the line of Ross MacMillan with RBC Capital Markets.
Two, I think, both for Amy. The first is that now that Azure gross margins have turned positive, would you say it'd be reasonable to assume that the [creative] cloud gross margin should continue to increase sequentially going forward? Or could other factors still create some volatility quarter-to-quarter?
Overall, we continue to expect each service is going to get better and better. That happens from 2 things: premium mix, revenue doing well as well as the efficiencies we expect to get in COGS resulting in gross margin improvement. Now to your specific question on can you expect it every quarter sequentially, the answer is not really. The mix amongst the services will always result in a pacing change. And so while year-over-year, you may not see as much, but you will see more sequential volatility as, frankly, you've seen over the past 6 quarters even when we've seen improvements in each of the underlying services, which tends to be how I focus on it a bit more.
That's helpful. And maybe one other if I could. Just on CapEx, I know that it was -- there's a timing delta here between Q3 and Q4, but I just wanted to step back. If you think about your CapEx plans ex LinkedIn as you came into the year and how you think you'll end up, are you going to be about on plan or do you think you'll be above or below?
Thanks. In general, for the full fiscal year, we'll be right at or a little below where I thought we would have been. And so that's why the full year perspective that growth will slow is still on track. And for simplicity, I generally would think about all the delta from Q3, I would encourage you just to move it into Q4 as you think about what to expect.
Our last question will come from the line of Philip Winslow with Wells Fargo.
Just a question on Office commercial. You guys reported another strong quarter here, 8% constant currency growth. Obviously, continuing that acceleration that you've had over the first 3 quarters of this year. Now I guess the question to Satya and then Amy. Satya, you still have a positive mix shift going on here because we see the unit count growth but also the revenue growth, so a positive spread there. Maybe help me walk through where you think we are in sort of this life cycle of Office 365 because you obviously have a lot of SKUs. And then Amy, in that context, kind of to the last question on gross margins for commercial cloud. Obviously, you made a lot of headway on Azure. How do you think where we are similarly on the life cycle on the gross margin side of 365?
Yes, I can start. I mean, I think with Office 365, we are trying to expand the appeal of Office 365 on multiple dimensions. A lot of what we're still seeing in play is the rapid adoption or the increased adoption of Office 365 E3, which is what I think is driving a lot of the growth, the ASP growth. Now we have a good start with what is the high end of the enterprise value, which is E5. Some of the value we have, whether it's voice or analytics and security, it resonates. And we're learning, we're improving and we're pushing forward on that front. At the same time, we are also introducing new SKUs for the front-line workers. This is one of the other first-time trends I'm seeing where CEOs on are more interested in productivity of their front-line workers, and so that's another exciting space. It comes at a different ASP point so it's not exactly the same as E5, but very important for us strategically to be able to increase the appeal of Office 365. We also are working to make Office 365 and seeing good traction in segments like small business. The other aspect of Office 365 which is important for us is the international element, because we really never had very high penetration of our higher-end server SKUs in the international markets, and we finally get to sort of do that with the service offering. So those are all the areas where there's significant room left, and we're not just standing still in terms of adding value for new segments, so those are all in play.
And the way you've seen that and I'll relate it to margins, is this continued and consistent installed base growth and even still having the opportunities Satya laid out. And most of the ARPU improvement that we've seen has been, in fact, still due to the E3 transition, not due to the E5 transition, so we still feel quite good about the opportunity, especially in some of the customers that have already moved to E3. And then in terms of gross margin, margin actually here has been steadily improving. We've been in this business a bit longer and it's more mature. I do think, here, the opportunity is also ARPU-based actually here in terms of continuing to see margin improvement, is continuing to raise the dollars per user that we realize to continue to see that grow.
That wraps up the Q&A portion of today's call. We look forward to seeing many of you in the coming months at various investor conferences and events. You can find the details, including webcast information, at the Microsoft Investor Relations website. Thank you for joining us today.
Thanks, all.
Thank you very much.
Thank you. This concludes today's teleconference. You may disconnect your lines at this time. Thank you for your participation.